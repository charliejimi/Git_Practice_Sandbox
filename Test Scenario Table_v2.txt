# 🧪 Test Scenario Table — IELTS Writing Intelligence System v2

以下測試案例表針對 User Story 1（快速下一詞建議）與 User Story 2（精確搭配驗證），包含關鍵演算法輸出、上下文長度、加權策略及 Consistency 驗證的完整驗收依據。

---

## 🧩 User Story 1 — 快速下一詞建議

|   測試編號   | 測試項目           | 測試步驟                      | 預期結果                  | 驗收條件                              |               |
| :------: | :------------- | :------------------------ | :-------------------- | :-------------------------------- | ------------- |
| **T1.1** | PPL–Band 對應準確性 | 使用多組句子終止於不同語境，觀察系統推薦詞     | 每個候選詞顯示正確 PPL、Band、評語 | PPL 與 Band 對應表一致；自動映射準確率 ≥ 95%    |               |
| **T1.2** | 模型自動更新校準       | 模擬跨季度語料變化後重新評分            | PPL–Band 映射自動重新校準     | 模型更新頻率 = 每季度一次                    |               |
| **T1.3** | 自定詞彙輸入一致性      | 使用者輸入自訂詞，計算 P(wₙ          | context)              | 顯示條件機率、PPL、Band                   | 結果演算法與系統候選詞一致 |
| **T1.4** | 上下文長度測試        | 測試不同句長下的預測詞準確度            | 系統僅使用最後 20 詞上下文       | 預測準確率不因句長變化顯著下降 (Δ ≤ 5%)          |               |
| **T1.5** | 例句重生成穩定性       | 點擊「🔄重新生成」5 次             | 新例句語義一致 (≥0.9)        | Self-Consistency=3；語義平均相似度 ≥ 0.92 |               |
| **T1.6** | 跨 Band 一致性     | 同一語句生成 Band 5–9 版本        | 語義保持一致、詞彙層級遞進         | Inter-Band 相似度 ≥ 0.9              |               |
| **T1.7** | 一致性評分輸出        | 生成例句後觀察 Consistency Score | 顯示 0–100 分數及標籤        | 分數 ≥ 85 則標示「Stable」               |               |
| **T1.8** | 自動回溯比對         | 連續生成 5 次例句                | 若任意版本 <0.9 → 自動再生     | 觸發 Semantic Traceback 模組          |               |

---

## ✳️ User Story 2 — 精確搭配驗證 (Validation)

|   測試編號   | 測試項目                  | 測試步驟                             | 預期結果                     | 驗收條件                          |
| :------: | :-------------------- | :------------------------------- | :----------------------- | :---------------------------- |
| **T2.1** | 搭配可靠度分數               | 輸入常見搭配 (e.g., make a decision)   | 顯示可靠度 ≥ 90               | L_score 正確計算 (MI 70% + P 30%) |
| **T2.2** | 不自然搭配檢測               | 輸入錯誤搭配 (e.g., do a decision)     | 系統顯示低 MI、低分數             | MI < 2 → Band ≤ 5；顯示替代建議      |
| **T2.3** | MI 與 P 加權策略           | 驗證加權比例對 L_score 影響               | L_score = 0.7·MI + 0.3·P | 結果與理論加權一致 ±2%                 |
| **T2.4** | 語料版本一致性               | 測試半年後語料更新版本                      | 分數變化符合預期但趨勢穩定            | 語料庫更新頻率 = 半年一次；舊版本可比對         |
| **T2.5** | Re-generation 一致性     | 對同一搭配生成多個 Band 版本                | 各版本語義相同，結構符合 Band 規範     | 相似度 ≥ 0.9，結構變異度合理             |
| **T2.6** | 跨模組一致性                | 驗證 Validation 與 Next-Word 模組輸出相符 | 相同語義輸入 → 相同一致性評分         | Cross-Module 一致性測試通過          |
| **T2.7** | Consistency Score 準確度 | 驗證重生成後一致性分數變化                    | 高一致句維持 ≥90；差異句下降明顯       | 分數與相似度相關係數 ≥ 0.9              |
| **T2.8** | Semantic Traceback 效能 | 模擬多次生成低一致例句                      | 系統自動標註「不一致」並再生           | 回溯比對準確率 ≥ 95%                 |

---

## ✅ 驗收標準總覽

| 模組                       | 驗收重點                        | 成功條件                                       |
| ------------------------ | --------------------------- | ------------------------------------------ |
| **Next-Word Prediction** | PPL 對應、上下文長度、跨 Band 一致性     | PPL–Band 映射準確率 ≥ 95%，上下文 20 詞，語義相似度 ≥ 0.9  |
| **Validation Engine**    | MI / P 加權策略、語料更新穩定性         | L_score 加權誤差 ≤ 2%，半年更新版本可回溯                |
| **Consistency Manager**  | Self-Consistency、回溯比對、跨模組對齊 | 平均相似度 ≥ 0.92；三輪 Self-Consistency 成功率 ≥ 95% |

---

# 🧩 Test Data Template — LLM-Based Evaluation (Markdown Table)

| 測試編號 |          模組          | 輸入內容 / Context                                                   | 預期候選詞或搭配              | 模型預期輸出                                  | 驗收參數                           | 備註               |
| :--: | :------------------: | :--------------------------------------------------------------- | :-------------------- | :-------------------------------------- | :----------------------------- | :--------------- |
|  TD1 | Next-Word Prediction | “The rapid advancement of technology has significantly”          | influenced            | PPL: 24.5 → Band 8 (流暢自然)               | Context=20 詞；Consistency ≥ 0.9 | 常見高頻學術表達         |
|  TD2 | Next-Word Prediction | “This phenomenon can be attributed to”                           | several factors       | PPL: 18.3 → Band 9                      | Context=20；Score ≥ 90          | 自然銜接度高           |
|  TD3 | Next-Word Prediction | “It is important to”                                             | acknowledge           | PPL: 41.2 → Band 7                      | Context=20；Self-Consistency=3  | 常見 IELTS 結構      |
|  TD4 |   Validation Engine  | “make a decision”                                                | —                     | MI=4.7, P=1.2e-3 → L_score=4.0 → Band 8 | MI/P=70/30；Reliability ≥ 90    | 高自然度搭配           |
|  TD5 |   Validation Engine  | “do a decision”                                                  | 建議替代：make a decision  | MI=1.3, P=0.8e-4 → L_score=1.5 → Band 5 | MI/P=70/30；Score < 50          | 不自然搭配            |
|  TD6 |   Validation Engine  | “take responsibility for”                                        | —                     | MI=5.2, P=2.1e-3 → L_score=4.7 → Band 9 | Consistency ≥ 0.9              | 高搭配強度            |
|  TD7 |  Consistency Manager | 句子 “Global warming causes serious” → re-generate Band 7 & Band 9 | damage / consequences | 相似度=0.91；Score=93                       | Inter-Band & Intra-Band 一致性測試  | 句法差異可控           |
|  TD8 |  Consistency Manager | 連續重生成相同 Band 7 版本                                                | —                     | 平均相似度=0.93；Score=95                     | Self-Consistency=3             | 穩定輸出驗證           |
|  TD9 |     Cross-Module     | 同一句於兩模組生成 (“play a vital role in”)                               | —                     | Validation 與 Prediction 一致              | Cross-Module Check: 相似度 ≥ 0.9  | 模組一致性測試          |
| TD10 |  Semantic Traceback  | 多輪生成 “in terms of”                                               | —                     | 若3次不一致 → 自動再生                           | 回溯比對準確率 ≥ 95%                  | Consistency 恢復檢驗 |

---

📘 **說明：**

* 本模板基於 **LLM 模擬語料**，確保與模型生成語言分布一致。
* PPL、MI、L_score 為模擬基準，可替換為實測數據。
* Consistency Score 用於驗證語義穩定性、句法一致性與跨模組對齊表現。
