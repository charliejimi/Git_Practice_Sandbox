<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç—›é»å°å‘å­¸ç¿’æ•™ç·´ - å…¨èƒ½æ¼”ç·´ç‰ˆ (å«åœ–è¡¨ä¸‹è¼‰)</title>
  <!-- è¼‰å…¥ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- è¼‰å…¥ React, ReactDOM, Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- è¼‰å…¥ PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <!-- è¼‰å…¥ Markdown æ¸²æŸ“åº« -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- è¼‰å…¥ Mermaid ç”¨æ–¼ç¹ªè£½åœ–è¡¨ -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
          },
          colors: {
            brand: {
              50: '#eff6ff',
              100: '#dbeafe',
              500: '#3b82f6',
              600: '#2563eb',
              700: '#1d4ed8',
              900: '#1e3a8a',
            }
          }
        }
      }
    }
  </script>
  <style>
    body { font-family: 'Inter', 'Noto Sans TC', 'sans-serif'; background-color: #f8fafc; }
    /* å„ªåŒ– Markdown æ¨£å¼ */
    .prose h2 { font-size: 1.4rem; font-weight: 700; color: #1e3a8a; margin-top: 1.5em; margin-bottom: 0.8em; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.3em; }
    .prose h3 { font-size: 1.1rem; font-weight: 700; color: #4b5563; margin-top: 1.2em; margin-bottom: 0.5em; }
    .prose ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
    .prose li { margin-bottom: 0.3em; }
    .prose p { margin-bottom: 0.8em; line-height: 1.6; }
    .prose strong { color: #ea580c; font-weight: 600; }
    .prose blockquote { border-left: 4px solid #3b82f6; padding-left: 1em; color: #4b5563; background-color: #f3f4f6; padding: 0.5rem 1rem; border-radius: 0.25rem; }
    
    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* Mermaid åœ–è¡¨æ¨£å¼ */
    .mermaid {
        background: white;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        min-height: 100px;
    }
    .error-box {
        background-color: #fee2e2;
        border: 1px solid #ef4444;
        color: #b91c1c;
        padding: 10px;
        border-radius: 8px;
        font-size: 0.85rem;
        white-space: pre-wrap;
        text-align: left;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    // åˆå§‹åŒ– Mermaid
    mermaid.initialize({ startOnLoad: false, theme: 'default', securityLevel: 'loose' });

    // è¨­å®š PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    const { useState, useEffect, useRef } = React;

    // --- è¼”åŠ©å‡½å¼ ---

    const readTextFile = (file) => new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = (e) => resolve({ name: file.name, content: e.target.result, type: 'text' });
      reader.onerror = (e) => reject(e);
      reader.readAsText(file);
    });

    const readPdfFile = async (file) => {
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        let fullText = "";
        for (let i = 1; i <= pdf.numPages; i++) {
          const page = await pdf.getPage(i);
          const textContent = await page.getTextContent();
          const pageText = textContent.items.map(item => item.str).join(" ");
          fullText += `[${file.name} ç¬¬ ${i} é ] ${pageText}\n`;
        }
        return { name: file.name, content: fullText, type: 'pdf' };
      } catch (e) {
        console.error(e);
        return { name: file.name, content: "ç„¡æ³•è®€å– PDF å…§å®¹", type: 'error' };
      }
    };

    // API å‘¼å« (åŒ…å« é‡è©¦æ©Ÿåˆ¶)
    async function callGeminiAPI(apiKey, prompt, systemInstruction) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const payload = {
            contents: [{ role: "user", parts: [{ text: prompt }] }],
            systemInstruction: { parts: [{ text: systemInstruction }] },
            generationConfig: {
                temperature: 0.4, 
            }
        };

        const maxRetries = 3;
        let attempt = 0;

        while (attempt < maxRetries) {
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.status === 503) throw new Error("Model overloaded (503)");

                const data = await response.json();
                
                if (!response.ok) {
                    const errorMessage = data.error?.message || "Unknown API Error";
                    if (errorMessage.toLowerCase().includes("overloaded") || response.status === 429) {
                        throw new Error(`Transient Error: ${errorMessage}`);
                    }
                    throw new Error(errorMessage);
                }

                return data.candidates?.[0]?.content?.parts?.[0]?.text || "";

            } catch (error) {
                console.warn(`Attempt ${attempt + 1} failed: ${error.message}`);
                const isRetryable = error.message.toLowerCase().includes("overloaded") || 
                                    error.message.includes("503") || 
                                    error.message.includes("429") ||
                                    error.message.includes("Failed to fetch");

                attempt++;
                if (!isRetryable || attempt >= maxRetries) throw error;
                
                const delay = Math.pow(2, attempt) * 1000 + (Math.random() * 1000);
                await new Promise(resolve => setTimeout(resolve, delay));
            }
        }
    }

    // --- ä¸»æ‡‰ç”¨ç¨‹å¼ ---

    function App() {
      const [apiKey, setApiKey] = useState("");
      const [step, setStep] = useState(1);
      
      const [painPoint, setPainPoint] = useState("");
      const [files, setFiles] = useState([]); 
      const [manualText, setManualText] = useState("");
      
      const [isLoading, setIsLoading] = useState(false);
      const [loadingMessage, setLoadingMessage] = useState("");
      
      const [quizData, setQuizData] = useState([]); 
      const [userAnswers, setUserAnswers] = useState({}); 
      const [evaluationResult, setEvaluationResult] = useState(null);

      // æ–°åŠŸèƒ½ç‹€æ…‹
      const [mindMapCode, setMindMapCode] = useState("");
      const [mindMapError, setMindMapError] = useState(""); // æ–°å¢éŒ¯èª¤ç‹€æ…‹
      const [isMindMapLoading, setIsMindMapLoading] = useState(false);
      
      const [roleplayHistory, setRoleplayHistory] = useState([]);
      const [roleplayInput, setRoleplayInput] = useState("");
      const [isRoleplayLoading, setIsRoleplayLoading] = useState(false);
      const [showRoleplay, setShowRoleplay] = useState(false);

      // è™•ç†æª”æ¡ˆä¸Šå‚³
      const handleFileUpload = async (e) => {
        const uploadedFiles = Array.from(e.target.files);
        setIsLoading(true);
        const processed = await Promise.all(uploadedFiles.map(async (file) => {
            if (file.name.endsWith('.pdf')) return await readPdfFile(file);
            if (file.name.endsWith('.txt') || file.name.endsWith('.md')) return await readTextFile(file);
            return null;
        }));
        setFiles(prev => [...prev, ...processed.filter(f => f)]);
        setIsLoading(false);
      };

      const removeFile = (index) => {
        setFiles(prev => prev.filter((_, i) => i !== index));
      };

      // STEP 1 -> 2 -> 3: ç”Ÿæˆåˆå§‹ Level 3 æ¸¬é©—
      const startAnalysis = async () => {
        if (!apiKey) { alert("è«‹è¼¸å…¥ API Key"); return; }
        if (!painPoint.trim()) { alert("è«‹è¼¸å…¥æ‚¨æƒ³è§£æ±ºçš„ç—›é»"); return; }
        if (files.length === 0 && !manualText.trim()) { alert("è«‹ä¸Šå‚³è³‡æ–™æˆ–è²¼ä¸Šæ–‡å­—"); return; }

        setStep(2);
        setIsLoading(true);
        
        let fullContext = manualText + "\n\n";
        files.forEach(f => fullContext += `=== æª”æ¡ˆ: ${f.name} ===\n${f.content}\n\n`);

        try {
            setLoadingMessage("AI æ­£åœ¨é–±è®€è³‡æ–™ï¼Œä¸¦è¨­è¨ˆã€ŒLevel 3: æ‡‰ç”¨å±¤ç´šã€çš„æƒ…å¢ƒè€ƒé¡Œ...");
            
            const systemPrompt = `
                ä½ æ˜¯ä¸€ä½åš´æ ¼çš„æ•™å­¸è¨­è¨ˆå¸«ï¼Œå°ˆç²¾æ–¼ Bloom's Taxonomy (å¸ƒé­¯å§†åˆ†é¡å­¸)ã€‚
                ä½ çš„ä»»å‹™æ˜¯æ ¹æ“šè³‡æ–™ï¼Œé‡å°ä½¿ç”¨è€…çš„ã€Œç—›é»ã€è¨­è¨ˆæ¸¬é©—ã€‚
                
                **é—œéµæŒ‡ä»¤ï¼š**
                1. **åªç”Ÿæˆ Level 3 (æ‡‰ç”¨ Application) é¡å‹çš„é¡Œç›®**ã€‚
                   - é¡Œç›®å¿…é ˆæ˜¯ã€Œæƒ…å¢ƒé¡Œ (Scenario-based)ã€ã€‚
                   - ç¦æ­¢å•ã€Œå®šç¾©æ˜¯ä»€éº¼ (What is...)ã€ã€‚
                   - å¿…é ˆå•ã€Œåœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œæ ¹æ“šè³‡æ–™ä½ è©²å¦‚ä½•åš (How to use...)ã€ã€‚
                2. **ç¯„åœé™åˆ¶**ï¼šåš´æ ¼é™åˆ¶åœ¨æä¾›çš„è³‡æ–™å…§å®¹ä¸­ã€‚
                3. **é¡Œç›®æ•¸é‡**ï¼š3 é¡Œã€‚
                4. **è¼¸å‡ºæ ¼å¼**ï¼šç´” JSON é™£åˆ— (Array of Objects)ï¼Œä¸è¦ Markdownã€‚
                
                JSON çµæ§‹ç¯„ä¾‹ï¼š
                [
                    {
                        "id": 1,
                        "scenario": "è©³ç´°çš„æƒ…å¢ƒæè¿°...",
                        "question": "é‡å°æ­¤æƒ…å¢ƒï¼Œæ ¹æ“šè³‡æ–™å…§å®¹ï¼Œä¸‹ä¸€æ­¥æœ€å¥½çš„è¡Œå‹•æ˜¯ï¼Ÿ",
                        "options": ["é¸é …A", "é¸é …B", "é¸é …C", "é¸é …D"],
                        "correctOptionIndex": 0,
                        "sourceReference": "è³‡æ–™ä¾†æº"
                    }
                ]
            `;

            const userPrompt = `
                ä½¿ç”¨è€…ç—›é»ï¼š${painPoint}
                
                å¯ç”¨è³‡æ–™å…§å®¹ï¼š
                ${fullContext.substring(0, 100000)}
                
                è«‹ç”Ÿæˆæ‡‰ç”¨å±¤ç´šçš„ JSON é¡Œç›®ã€‚
            `;

            const resultText = await callGeminiAPI(apiKey, userPrompt, systemPrompt);
            const jsonStr = resultText.replace(/```json/g, '').replace(/```/g, '').trim();
            const questions = JSON.parse(jsonStr);

            if (!Array.isArray(questions) || questions.length === 0) throw new Error("ç„¡æ³•ç”Ÿæˆé¡Œç›®");

            setQuizData(questions);
            setStep(3); 
        } catch (error) {
            alert("ç”Ÿæˆå¤±æ•—: " + error.message);
            setStep(1);
        } finally {
            setIsLoading(false);
        }
      };

      // STEP 3 -> 4: æ‰¹æ”¹
      const submitQuiz = async () => {
        if (Object.keys(userAnswers).length < quizData.length) {
            alert("è«‹å®Œæˆæ‰€æœ‰é¡Œç›®å¾Œå†æäº¤ï¼");
            return;
        }

        setStep(2); 
        setIsLoading(true);
        setLoadingMessage("æ­£åœ¨æ‰¹æ”¹è©¦å·ï¼Œä¸¦ç”Ÿæˆæ·±åº¦åˆ†æå ±å‘Š...");

        let userAnswerSummary = "";
        let scoreRaw = 0;
        
        quizData.forEach((q, idx) => {
            const userIdx = userAnswers[q.id];
            const isCorrect = userIdx === q.correctOptionIndex;
            if(isCorrect) scoreRaw += (100 / quizData.length);
            
            userAnswerSummary += `
            é¡Œç›® ${idx+1}: ${q.scenario} - ${q.question}
            ä½¿ç”¨è€…é¸æ“‡: ${q.options[userIdx]} (${isCorrect ? "æ­£ç¢º" : "éŒ¯èª¤"})
            æ­£ç¢ºç­”æ¡ˆ: ${q.options[q.correctOptionIndex]}
            \n`;
        });

        try {
            const systemPrompt = `
                ä½ æ˜¯ä¸€ä½é«˜éšå­¸ç¿’æ•™ç·´ã€‚ä½¿ç”¨è€…å‰›å®Œæˆäº†ä¸€ä»½ã€ŒLevel 3 æ‡‰ç”¨ã€çš„æ¸¬é©—ã€‚
                ä½ çš„ä»»å‹™æ˜¯æä¾›æ·±åº¦å›é¥‹ï¼Œä¸¦å°‡ä½¿ç”¨è€…çš„æ€ç¶­å¼•å°è‡³æ›´é«˜å±¤æ¬¡ (Level 4 & 5)ã€‚

                è«‹åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿä¸¦è¼¸å‡º Markdown å ±å‘Šï¼š

                ### ç¬¬ä¸€éƒ¨åˆ†ï¼šè¨ºæ–·èˆ‡è£œå¼· (é‡å° Level 3)
                1. å…¬å¸ƒåˆ†æ•¸ (ç›®å‰å¾—åˆ†ç´„ ${Math.round(scoreRaw)})ã€‚
                2. **éŒ¯é¡Œåˆ†æ**ï¼šé‡å°ä½¿ç”¨è€…ç­”éŒ¯çš„é¡Œç›®ï¼ŒæŒ‡å‡ºä»–èª¤è§£äº†è³‡æ–™ä¸­çš„å“ªå€‹è§€å¿µï¼Œä¸¦å‘Šè¨´ä»–æ‡‰è©²å»è®€è³‡æ–™çš„å“ªå€‹ç« ç¯€/æ®µè½ã€‚

                ### ç¬¬äºŒéƒ¨åˆ†ï¼šé€²éšæ€ç¶­æŒ‘æˆ° (Level 4 & 5)
                æ ¹æ“šä½¿ç”¨è€…çš„ä½œç­”æƒ…æ³ï¼Œé‡èº«æ‰“é€ é€²éšæ€è€ƒé¡Œã€‚
                **å°æ–¼æ¯å€‹å•é¡Œï¼Œä½ å¿…é ˆæä¾›ã€ŒğŸ’¡ æ€è€ƒæç¤ºã€ä»¥åŠã€Œâœ… åƒè€ƒè§£ç­” (Reference Answer)ã€ã€‚**

                1. **Level 4: åˆ†æ (Analysis)**
                   - è¨­è¨ˆ 1 å€‹å•é¡Œï¼Œè¦æ±‚ä½¿ç”¨è€…åˆ†æè³‡æ–™ä¸­ä¸åŒå…ƒç´ ä¹‹é–“çš„é—œä¿‚ã€‚
                   
                2. **Level 5: è©•é‘‘èˆ‡å‰µé€  (Evaluation & Creation)**
                   - è¨­è¨ˆ 1 å€‹å•é¡Œï¼Œè¦æ±‚ä½¿ç”¨è€…é€²è¡Œåƒ¹å€¼åˆ¤æ–·æˆ–æå‡ºæ–°æ–¹æ¡ˆã€‚
                   
                **è¼¸å‡ºæ ¼å¼è¦æ±‚ï¼š** ä½¿ç”¨ Markdownã€‚
            `;

            const userPrompt = `
                ä½¿ç”¨è€…ç—›é»ï¼š${painPoint}
                æ¸¬é©—ä½œç­”ç´€éŒ„ï¼š${userAnswerSummary}
                è³‡æ–™æª”æ¡ˆåˆ—è¡¨ï¼š${files.map(f => f.name).join(", ")}
            `;

            const feedback = await callGeminiAPI(apiKey, userPrompt, systemPrompt);
            setEvaluationResult({ score: Math.round(scoreRaw), feedback });
            setStep(4);
        } catch (e) {
            console.error(e);
            alert("è©•ä¼°éç¨‹ç™¼ç”ŸéŒ¯èª¤: " + e.message);
            setStep(3);
        } finally {
            setIsLoading(false);
        }
      };

      // --- æ–°åŠŸèƒ½ï¼šç”Ÿæˆå¿ƒæ™ºåœ– (ä¿®å¾©ç‰ˆ) ---
      const generateMindMap = async () => {
        if(isMindMapLoading) return;
        setIsMindMapLoading(true);
        setMindMapError("");
        setMindMapCode("");

        try {
            let fullContext = manualText + "\n\n";
            files.forEach(f => fullContext += `=== æª”æ¡ˆ: ${f.name} ===\n${f.content}\n\n`);

            // ä¿®æ”¹è™•ï¼šæ›´æ–° System Promptï¼Œç¦æ­¢ subgraph ä¸¦å¼·åŒ–èªæ³•é™åˆ¶
            const systemPrompt = `
                ä½ æ˜¯ä¸€å€‹ Mermaid.js å°ˆå®¶ã€‚è«‹æ ¹æ“šæä¾›çš„è³‡æ–™ï¼Œé‡å°ã€Œ${painPoint}ã€é€™å€‹ä¸»é¡Œï¼Œç”Ÿæˆä¸€å€‹è¦–è¦ºåŒ–çš„æµç¨‹åœ– (Flowchart)ã€‚

                åš´æ ¼è¦æ±‚ï¼š
                1. **åªå›å‚³ä»£ç¢¼**ï¼šä¸è¦æœ‰ Markdown æ¨™è¨˜ (ä¸è¦æœ‰ \`\`\`mermaid)ï¼Œä¸è¦æœ‰é–‹é ­çš„æ–‡å­—è§£é‡‹ã€‚
                2. **èªæ³•æ­£ç¢ºæ€§ (é—œéµ)**ï¼š
                   - **ç¦æ­¢ä½¿ç”¨ subgraph**ï¼šç‚ºäº†é¿å…èªæ³•éŒ¯èª¤ï¼Œè«‹å®Œå…¨ä¸è¦ä½¿ç”¨ subgraphï¼Œåƒ…ä½¿ç”¨ç¯€é»èˆ‡é€£ç·šã€‚
                   - **ç¯€é» ID å¿…é ˆæ˜¯ç´”è‹±æ–‡æ•¸å­—** (ä¾‹å¦‚ A1, B2, Node3)ï¼Œä¸è¦ç”¨ä¸­æ–‡ç•¶ IDã€‚
                   - **æ‰€æœ‰ç¯€é»é¡¯ç¤ºæ–‡å­—å¿…é ˆä½¿ç”¨è‹±æ–‡é›™å¼•è™Ÿ \`""\` åŒ…è¦†**ï¼Œç‰¹åˆ¥æ˜¯åŒ…å«ä¸­æ–‡ã€æ¨™é»ç¬¦è™Ÿæˆ–æ‹¬è™Ÿ \`()\` æ™‚ã€‚
                   - âŒ çµ•å°éŒ¯èª¤ç¯„ä¾‹ï¼šA[ç—›é»(åˆ†æ)]ã€B(æ¸¬è©¦)ã€subgraph æµç¨‹(ä¸€)
                   - âœ… æ­£ç¢ºç¯„ä¾‹ï¼šA1["ç—›é»(åˆ†æ)"] --> B1["è§£æ±ºæ–¹æ¡ˆ"]
                3. **æ–¹å‘**ï¼šä½¿ç”¨ \`graph TD\` (ç”±ä¸Šåˆ°ä¸‹)ã€‚
                4. **çµæ§‹**ï¼šä¿æŒç°¡å–®æ¸…æ™°ï¼Œå±¤ç´šåˆ†æ˜ï¼Œå¹«åŠ©ä½¿ç”¨è€…ç†è§£é‚è¼¯ã€‚
            `;
            
            const prompt = `è³‡æ–™å…§å®¹ï¼š\n${fullContext.substring(0, 50000)}\n\nè«‹ç”Ÿæˆé—œæ–¼ã€Œ${painPoint}ã€çš„ Mermaid ä»£ç¢¼ (graph TD)ã€‚è«‹è¨˜å¾—ï¼šä¸è¦ä½¿ç”¨ subgraphï¼Œæ‰€æœ‰æ–‡å­—åŠ ä¸Šé›™å¼•è™Ÿã€‚`;
            
            const rawResponse = await callGeminiAPI(apiKey, prompt, systemPrompt);
            
            // æ¸…ç†ä»£ç¢¼ï¼šç§»é™¤ markdown æ¨™è¨˜ï¼Œä¸¦å˜—è©¦åªæå– graph/mindmap é–‹é ­çš„éƒ¨åˆ†
            let cleanCode = rawResponse.replace(/```mermaid/g, '').replace(/```/g, '').trim();
            
            // å¦‚æœæ¨¡å‹é‚„æ˜¯è¬›äº†å»¢è©±ï¼Œå˜—è©¦æå–ä»£ç¢¼å€å¡Š
            const codeMatch = cleanCode.match(/graph\s+[A-Za-z]+\s*[\s\S]*/);
            if (codeMatch) {
                cleanCode = codeMatch[0];
            }

            setMindMapCode(cleanCode);

        } catch(e) {
            alert("å¿ƒæ™ºåœ–ç”Ÿæˆå¤±æ•—: " + e.message);
            setMindMapError(e.message);
        } finally {
            setIsMindMapLoading(false);
        }
      };

      // ä¸‹è¼‰å¿ƒæ™ºåœ– (SVG)
      const downloadMindMap = () => {
        const svgElement = document.querySelector('.mermaid svg');
        if (!svgElement) {
            alert("ç„¡æ³•æ‰¾åˆ°åœ–è¡¨å…ƒç´ ï¼Œè«‹å…ˆç”Ÿæˆåœ–è¡¨");
            return;
        }
        
        // å–å¾— SVG çš„åŸå§‹ç¢¼
        const serializer = new XMLSerializer();
        let source = serializer.serializeToString(svgElement);
        
        // ç¢ºä¿æœ‰ namespace (é¿å…æŸäº›ç€è¦½å™¨è§£æéŒ¯èª¤)
        if(!source.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)){
            source = source.replace(/^<svg/, '<svg xmlns="http://www.w3.org/2000/svg"');
        }

        // å»ºç«‹ Blob ä¸¦ä¸‹è¼‰
        const blob = new Blob([source], {type: "image/svg+xml;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        
        const link = document.createElement("a");
        link.href = url;
        link.download = `mindmap_${new Date().getTime()}.svg`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      };

      // ç•¶ mindMapCode æ›´æ–°æ™‚ï¼Œé‡æ–°æ¸²æŸ“ mermaid
      useEffect(() => {
        if (mindMapCode) {
            setMindMapError("");
            try {
                // ç§»é™¤èˆŠçš„å±¬æ€§ä»¥å¼·åˆ¶é‡ç¹ª
                const element = document.querySelector('.mermaid');
                if(element) {
                    element.removeAttribute('data-processed');
                    element.innerHTML = mindMapCode; // å…ˆæ”¾å…¥ç´”æ–‡å­—
                    
                    mermaid.init(undefined, element).catch(err => {
                         console.error("Mermaid Init Error", err);
                         setMindMapError("åœ–è¡¨èªæ³•éŒ¯èª¤ï¼Œè«‹é‡è©¦ã€‚\n\nåŸå§‹ä»£ç¢¼:\n" + mindMapCode);
                    });
                }
            } catch (e) {
                console.error("Mermaid Render Error", e);
                setMindMapError("åœ–è¡¨æ¸²æŸ“å¤±æ•—:\n" + e.message);
            }
        }
      }, [mindMapCode]);


      // --- æ–°åŠŸèƒ½ï¼šè§’è‰²æ‰®æ¼” ---
      const startRoleplay = async () => {
        setShowRoleplay(true);
        if (roleplayHistory.length > 0) return; // å·²ç¶“é–‹å§‹éäº†

        setIsRoleplayLoading(true);
        let fullContext = manualText + "\n\n";
        files.forEach(f => fullContext += `=== æª”æ¡ˆ: ${f.name} ===\n${f.content}\n\n`);

        const systemPrompt = `
            ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„æ¨¡æ“¬æ¼”ç·´ AIã€‚æ ¹æ“šä½¿ç”¨è€…çš„ç—›é»ã€Œ${painPoint}ã€èˆ‡è³‡æ–™å…§å®¹ï¼Œè«‹è¨­è¨ˆä¸€å€‹ç°¡çŸ­çš„æ¨¡æ“¬æƒ…å¢ƒã€‚
            
            è¨­å®šï¼š
            1. ä½ æ‰®æ¼”ä¸€å€‹èˆ‡ç—›é»ç›¸é—œçš„è§’è‰² (ä¾‹å¦‚ï¼šæŒ‘æƒ•çš„å®¢æˆ¶ã€åš´æ ¼çš„è€é—†ã€å›°æƒ‘çš„å­¸ç”Ÿç­‰)ï¼Œè«‹æ ¹æ“šè³‡æ–™å…§å®¹æ‰¾å‡ºæœ€é©åˆçš„è§’è‰²ã€‚
            2. ä½¿ç”¨è€…æ‰®æ¼”ä»–è‡ªå·±ï¼Œè©¦åœ–æ‡‰ç”¨è³‡æ–™ä¸­çš„çŸ¥è­˜ä¾†è§£æ±ºå•é¡Œã€‚
            3. ä½ çš„ç›®æ¨™æ˜¯æå‡ºæŒ‘æˆ°ï¼Œæ¸¬è©¦ä½¿ç”¨è€…æ˜¯å¦çœŸçš„æœƒã€Œæ‡‰ç”¨ã€è³‡æ–™ä¸­çš„ç­–ç•¥ã€‚
            
            ä»»å‹™ï¼š
            è«‹å…ˆé–‹å ´ï¼Œèªªæ˜ä½ æ˜¯èª°ï¼Œä»¥åŠç›®å‰ç™¼ç”Ÿçš„ç‹€æ³ï¼Œç„¶å¾Œç­‰å¾…ä½¿ç”¨è€…å›æ‡‰ã€‚
            (è«‹ä¿æŒå°è©±ç°¡çŸ­æœ‰åŠ›ï¼Œæ¯æ¬¡å›æ‡‰ä¸è¶…é 100 å­—)
        `;
        
        try {
            const initialMsg = await callGeminiAPI(apiKey, "è«‹é–‹å§‹æ¨¡æ“¬æ¼”ç·´ï¼Œè¨­å®šå¥½å ´æ™¯ä¸¦å°æˆ‘èªªç¬¬ä¸€å¥è©±ã€‚", systemPrompt);
            setRoleplayHistory([{role: 'model', text: initialMsg}]);
        } catch(e) {
            alert("ç„¡æ³•å•Ÿå‹•è§’è‰²æ‰®æ¼”");
            setShowRoleplay(false);
        } finally {
            setIsRoleplayLoading(false);
        }
      };

      const sendRoleplayMessage = async () => {
        if (!roleplayInput.trim() || isRoleplayLoading) return;
        
        const newHistory = [...roleplayHistory, {role: 'user', text: roleplayInput}];
        setRoleplayHistory(newHistory);
        setRoleplayInput("");
        setIsRoleplayLoading(true);

        let fullContext = manualText + "\n\n";
        files.forEach(f => fullContext += `=== æª”æ¡ˆ: ${f.name} ===\n${f.content}\n\n`);

        const systemPrompt = `
            æˆ‘å€‘æ­£åœ¨é€²è¡Œè§’è‰²æ‰®æ¼”æ¨¡æ“¬ã€‚
            ä½¿ç”¨è€…ç—›é»ï¼š${painPoint}
            è³‡æ–™èƒŒæ™¯ï¼š${fullContext.substring(0, 20000)}
            
            ä½ æ‰®æ¼”çš„è§’è‰²ï¼šæ ¹æ“šä¹‹å‰çš„å°è©±å»¶çºŒè§’è‰²è¨­å®šã€‚
            ç›®æ¨™ï¼šæŒçºŒæŒ‘æˆ°ä½¿ç”¨è€…ï¼Œçœ‹ä»–èƒ½å¦æ‡‰ç”¨è³‡æ–™ä¸­çš„çŸ¥è­˜ã€‚
            å›è¦†é™åˆ¶ï¼šç¹é«”ä¸­æ–‡ï¼Œ100å­—ä»¥å…§ï¼Œå£èªåŒ–ã€‚
        `;

        const chatContext = newHistory.map(msg => `${msg.role}: ${msg.text}`).join('\n');

        try {
            const reply = await callGeminiAPI(apiKey, chatContext, systemPrompt);
            setRoleplayHistory(prev => [...prev, {role: 'model', text: reply}]);
        } catch(e) {
            console.error(e);
        } finally {
            setIsRoleplayLoading(false);
        }
      };


      const reset = () => {
        setStep(1);
        setQuizData([]);
        setUserAnswers({});
        setEvaluationResult(null);
        setMindMapCode("");
        setMindMapError("");
        setRoleplayHistory([]);
        setShowRoleplay(false);
      };

      // --- UI æ¸²æŸ“ ---

      return (
        <div className="min-h-screen flex flex-col items-center py-10 px-4 md:px-0 max-w-5xl mx-auto">
          <header className="mb-8 text-center">
            <h1 className="text-3xl font-bold text-gray-800 mb-2">ğŸš€ ç—›é»å°å‘å­¸ç¿’æ•™ç·´ <span className="text-sm bg-purple-600 text-white px-2 py-1 rounded ml-2">å…¨èƒ½æ¼”ç·´ç‰ˆ</span></h1>
            <p className="text-gray-600">L3 æ‡‰ç”¨æª¢æ¸¬ â” L4/L5 æ·±åº¦åˆ†æ â” <span className="text-purple-600 font-bold">AI æƒ…å¢ƒæ¼”ç·´ & å¿ƒæ™ºåœ–</span></p>
          </header>

          <div className="w-full bg-white shadow-xl rounded-2xl overflow-hidden border border-gray-200">
            
            {/* é€²åº¦æ¢ */}
            <div className="bg-gray-100 h-2 w-full flex">
                <div className={`h-full bg-brand-500 transition-all duration-500 ${step >= 1 ? 'w-1/4' : 'w-0'}`}></div>
                <div className={`h-full bg-brand-500 transition-all duration-500 ${step >= 2 ? 'w-1/4' : 'w-0'}`}></div>
                <div className={`h-full bg-brand-500 transition-all duration-500 ${step >= 3 ? 'w-1/4' : 'w-0'}`}></div>
                <div className={`h-full bg-purple-500 transition-all duration-500 ${step >= 4 ? 'w-1/4' : 'w-0'}`}></div>
            </div>

            {/* STEP 1: è¼¸å…¥è³‡æ–™ */}
            {step === 1 && (
                <div className="p-8 space-y-6">
                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Google Gemini API Key</label>
                        <input type="password" value={apiKey} onChange={e=>setApiKey(e.target.value)} className="w-full p-2 border rounded-md focus:ring-2 focus:ring-brand-500 focus:outline-none" placeholder="è«‹è¼¸å…¥æ‚¨çš„ API Key (AIzaSy...)" />
                    </div>

                    <div className="grid md:grid-cols-2 gap-8">
                        <div className="space-y-4">
                            <h2 className="text-xl font-bold text-brand-700 flex items-center">
                                <span className="bg-brand-100 text-brand-700 w-8 h-8 rounded-full flex items-center justify-center mr-2 text-sm">1</span>
                                å®šç¾©æ‚¨çš„ç—›é»
                            </h2>
                            <textarea 
                                className="w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:outline-none"
                                placeholder="ä¾‹å¦‚ï¼šæˆ‘åœ¨å°ˆæ¡ˆç®¡ç†ä¸­ï¼Œå¸¸å¸¸ç„¡æ³•æº–ç¢ºé ä¼°æ™‚ç¨‹... æˆ‘æƒ³çŸ¥é“å¦‚ä½•è§£æ±ºèˆ‡å®¢æˆ¶çš„æºé€šè¡çª..."
                                value={painPoint}
                                onChange={(e) => setPainPoint(e.target.value)}
                            ></textarea>
                        </div>

                        <div className="space-y-4">
                            <h2 className="text-xl font-bold text-gray-700 flex items-center">
                                <span className="bg-gray-200 text-gray-700 w-8 h-8 rounded-full flex items-center justify-center mr-2 text-sm">2</span>
                                æä¾›å­¸ç¿’è³‡æ–™
                            </h2>
                            <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:bg-gray-50 transition relative">
                                <input type="file" multiple accept=".pdf,.txt,.md" onChange={handleFileUpload} className="absolute inset-0 w-full h-full opacity-0 cursor-pointer" />
                                <div className="text-brand-600 font-semibold">é»æ“Šä¸Šå‚³ PDF, TXT, MD</div>
                                <p className="text-xs text-gray-400 mt-1">æˆ–ç›´æ¥åœ¨ä¸‹æ–¹è²¼ä¸Šæ–‡å­—</p>
                            </div>
                            
                            {files.length > 0 && (
                                <ul className="space-y-2 max-h-32 overflow-y-auto bg-gray-50 p-2 rounded">
                                    {files.map((f, i) => (
                                        <li key={i} className="flex justify-between items-center text-sm text-gray-600 bg-white p-2 border rounded shadow-sm">
                                            <span className="truncate max-w-[80%]">{f.type === 'pdf' ? 'ğŸ“„' : 'ğŸ“'} {f.name}</span>
                                            <button onClick={() => removeFile(i)} className="text-red-500 hover:text-red-700">âœ•</button>
                                        </li>
                                    ))}
                                </ul>
                            )}

                            <textarea 
                                className="w-full h-20 p-3 border border-gray-300 rounded-lg text-sm"
                                placeholder="æˆ–åœ¨æ­¤ç›´æ¥è²¼ä¸Šå…§å®¹..."
                                value={manualText}
                                onChange={(e) => setManualText(e.target.value)}
                            ></textarea>
                        </div>
                    </div>

                    <div className="flex justify-center mt-8">
                        <button 
                            onClick={startAnalysis}
                            disabled={isLoading}
                            className="bg-brand-600 text-white px-8 py-3 rounded-full shadow-lg hover:bg-brand-700 font-bold transition transform hover:-translate-y-1 disabled:opacity-50 flex items-center"
                        >
                            {isLoading ? 'è™•ç†ä¸­...' : 'é–‹å§‹åˆ†æèˆ‡ç”Ÿæˆæ¸¬é©— â”'}
                        </button>
                    </div>
                </div>
            )}

            {/* STEP 2: Loading */}
            {step === 2 && (
                <div className="p-20 flex flex-col items-center justify-center text-center">
                    <div className="loader mb-6"></div>
                    <h3 className="text-xl font-bold text-gray-700">{loadingMessage}</h3>
                </div>
            )}

            {/* STEP 3: L3 æ‡‰ç”¨æ¸¬é©— */}
            {step === 3 && (
                <div className="p-8 bg-gray-50 min-h-[500px]">
                    <div className="flex justify-between items-end mb-6">
                        <h2 className="text-2xl font-bold text-brand-800 flex items-center">
                            ğŸ¯ Level 3 æ‡‰ç”¨èƒ½åŠ›æª¢æ¸¬
                        </h2>
                    </div>

                    <div className="space-y-8">
                        {quizData.map((q, index) => (
                            <div key={q.id} className="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                                <div className="mb-4">
                                    <span className="inline-block bg-brand-100 text-brand-800 text-xs px-2 py-1 rounded font-bold mb-2">
                                        æƒ…å¢ƒé¡Œ {index + 1}
                                    </span>
                                    <p className="text-gray-800 font-medium text-lg leading-relaxed">{q.scenario}</p>
                                    <p className="text-gray-900 font-bold mt-2">Q: {q.question}</p>
                                </div>
                                <div className="space-y-2">
                                    {q.options.map((opt, optIndex) => (
                                        <label key={optIndex} className={`flex items-center p-3 rounded-lg border cursor-pointer transition ${userAnswers[q.id] === optIndex ? 'bg-brand-50 border-brand-500 ring-1 ring-brand-500' : 'hover:bg-gray-50 border-gray-200'}`}>
                                            <input type="radio" name={`question-${q.id}`} className="w-4 h-4 text-brand-600 focus:ring-brand-500" checked={userAnswers[q.id] === optIndex} onChange={() => setUserAnswers(prev => ({...prev, [q.id]: optIndex}))} />
                                            <span className="ml-3 text-gray-700">{opt}</span>
                                        </label>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </div>

                    <div className="mt-8 flex justify-center">
                        <button onClick={submitQuiz} className="bg-green-600 text-white px-8 py-3 rounded-lg shadow-md hover:bg-green-700 font-bold transition text-lg w-full md:w-auto shadow-green-200">
                            æäº¤ç­”æ¡ˆ â” é€²å…¥æ·±åº¦åˆ†æèˆ‡å¯¦æˆ°æ¼”ç·´
                        </button>
                    </div>
                </div>
            )}

            {/* STEP 4: çµæœèˆ‡ L4/L5 æŒ‘æˆ° + æ–°åŠŸèƒ½å€ */}
            {step === 4 && evaluationResult && (
                <div className="p-8">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-bold text-gray-800">ğŸ“Š å­¸ç¿’è¨ºæ–·èˆ‡å¼·åŒ–ä¸­å¿ƒ</h2>
                        <button onClick={reset} className="text-gray-500 hover:text-brand-600 underline">é–‹å§‹æ–°æ¢ç´¢</button>
                    </div>

                    {/* NEW: L3 æ‡‰ç”¨é¡Œå›é¡§ (Grid é¡¯ç¤º) */}
                    <h3 className="text-xl font-bold text-gray-700 mb-4">L3 æ‡‰ç”¨é¡Œå›é¡§</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                        {quizData.map((q) => {
                            const isCorrect = userAnswers[q.id] === q.correctOptionIndex;
                            const userChoice = q.options[userAnswers[q.id]];
                            
                            return (
                                <div key={q.id} className={`p-5 rounded-xl border flex gap-4 ${isCorrect ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`}>
                                    {/* Icon */}
                                    <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${isCorrect ? 'bg-green-500' : 'bg-red-500'}`}>
                                        {isCorrect ? 'âœ“' : 'âœ•'}
                                    </div>
                                    
                                    {/* Text Content */}
                                    <div className="flex-1">
                                        <p className="text-gray-800 font-bold text-sm mb-2">{q.question}</p>
                                        <p className="text-sm">
                                            <span className="text-gray-500">ä½ çš„é¸æ“‡ï¼š</span>
                                            <span className={`font-bold ${isCorrect ? 'text-green-600' : 'text-red-600'}`}>
                                                {userChoice}
                                            </span>
                                        </p>
                                        {!isCorrect && (
                                            <p className="text-xs text-gray-500 mt-1">
                                                (æ­£ç¢ºç­”æ¡ˆ: {q.options[q.correctOptionIndex]})
                                            </p>
                                        )}
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    {/* ä¸ŠåŠéƒ¨ï¼šæˆç¸¾èˆ‡æ–‡å­—å ±å‘Š */}
                    <div className="flex flex-col md:flex-row gap-6 mb-8">
                        <div className="bg-gradient-to-br from-brand-600 to-brand-800 text-white p-6 rounded-2xl md:w-1/3 flex flex-col items-center justify-center shadow-lg relative overflow-hidden">
                            <span className="text-lg opacity-90 relative z-10">L3 æ‡‰ç”¨é¡Œå¾—åˆ†</span>
                            <span className="text-6xl font-bold my-2 relative z-10">{evaluationResult.score}</span>
                            <span className="text-sm bg-white/20 px-3 py-1 rounded-full relative z-10">
                                {evaluationResult.score >= 80 ? 'è¡¨ç¾å„ªç•° ğŸŒŸ' : 'æŒçºŒåŠ æ²¹ ğŸ’ª'}
                            </span>
                        </div>
                        
                        <div className="bg-white p-6 rounded-2xl md:w-2/3 border border-gray-200 shadow-sm overflow-y-auto max-h-[50vh]">
                            <h3 className="text-lg font-bold text-gray-800 mb-2 border-b pb-2">ğŸ“¢ AI è¨ºæ–·èˆ‡ L4/L5 æŒ‘æˆ°ï¼ˆå«è§£ç­”ï¼‰</h3>
                            <div className="prose prose-sm max-w-none text-gray-700" dangerouslySetInnerHTML={{ __html: marked.parse(evaluationResult.feedback) }} />
                        </div>
                    </div>

                    {/* ä¸‹åŠéƒ¨ï¼šå¼·åŒ–å·¥å…·ç®± (æ–°åŠŸèƒ½) */}
                    <div className="border-t pt-8">
                        <h3 className="text-xl font-bold text-purple-800 mb-4 flex items-center">
                             ğŸ› ï¸ å¯¦æˆ°å¼·åŒ–å·¥å…·ç®±
                             <span className="ml-2 text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded">Power by Gemini LLM</span>
                        </h3>
                        
                        <div className="grid md:grid-cols-2 gap-6">
                            
                            {/* å·¥å…· 1: çŸ¥è­˜é—œè¯åœ– */}
                            <div className="bg-blue-50 p-6 rounded-xl border border-blue-100">
                                <h4 className="font-bold text-blue-800 mb-2 flex items-center">
                                    ğŸ§  çŸ¥è­˜é—œè¯åœ– (Mind Map) âœ¨
                                </h4>
                                <p className="text-sm text-blue-600 mb-4">å°‡è¤‡é›œçš„æ–‡å­—è³‡æ–™è½‰åŒ–ç‚ºè¦–è¦ºåŒ–çš„æµç¨‹åœ–ï¼Œå¹«æ‚¨é‡æ¸…é‚è¼¯ã€‚</p>
                                
                                {!mindMapCode && !mindMapError && (
                                    <button onClick={generateMindMap} disabled={isMindMapLoading} className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition font-medium">
                                        {isMindMapLoading ? 'ç”Ÿæˆåœ–è¡¨ä¸­...' : 'ç”Ÿæˆè¦–è¦ºåŒ–åœ–è¡¨'}
                                    </button>
                                )}

                                {mindMapError && (
                                    <div className="error-box mb-4">
                                        {mindMapError}
                                    </div>
                                )}
                                {mindMapError && (
                                     <button onClick={generateMindMap} className="w-full bg-red-100 text-red-700 py-2 rounded-lg hover:bg-red-200 transition font-medium">
                                        é‡è©¦ç”Ÿæˆ
                                    </button>
                                )}

                                <div className={`mermaid overflow-x-auto ${!mindMapCode ? 'hidden' : ''}`}>
                                    {/* Mermaid content injected via effect */}
                                </div>

                                {/* ä¸‹è¼‰æŒ‰éˆ• */}
                                {mindMapCode && !mindMapError && (
                                    <div className="mt-4 flex gap-2">
                                        <button onClick={downloadMindMap} className="flex-1 bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition font-medium text-sm">
                                            ä¸‹è¼‰ SVG åœ–è¡¨ ğŸ“¥
                                        </button>
                                        <button onClick={generateMindMap} className="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300 transition font-medium text-sm">
                                            é‡æ–°ç”Ÿæˆ ğŸ”„
                                        </button>
                                    </div>
                                )}
                            </div>

                            {/* å·¥å…· 2: æƒ…å¢ƒæ¨¡æ“¬æ¼”ç·´ */}
                            <div className="bg-pink-50 p-6 rounded-xl border border-pink-100 flex flex-col">
                                <h4 className="font-bold text-pink-800 mb-2 flex items-center">
                                    ğŸ­ æƒ…å¢ƒæ¨¡æ“¬æ¼”ç·´ (Roleplay) âœ¨
                                </h4>
                                <p className="text-sm text-pink-600 mb-4">AI å°‡æ‰®æ¼”å®¢æˆ¶æˆ–ä¸»ç®¡ï¼Œèˆ‡æ‚¨é€²è¡ŒçœŸå¯¦å°è©±ï¼Œæ¸¬è©¦æ‚¨çš„è‡¨å ´åæ‡‰ã€‚</p>
                                
                                {!showRoleplay ? (
                                    <button onClick={startRoleplay} disabled={isRoleplayLoading} className="w-full bg-pink-600 text-white py-2 rounded-lg hover:bg-pink-700 transition font-medium mt-auto">
                                        {isRoleplayLoading ? 'æº–å‚™å ´æ™¯ä¸­...' : 'é–‹å§‹æ¨¡æ“¬æ¼”ç·´'}
                                    </button>
                                ) : (
                                    <div className="flex flex-col h-[400px] bg-white rounded-lg border border-pink-200">
                                        <div className="flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50">
                                            {roleplayHistory.map((msg, i) => (
                                                <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                    <div className={`max-w-[85%] p-3 rounded-lg text-sm ${msg.role === 'user' ? 'bg-pink-600 text-white' : 'bg-white border border-gray-200 text-gray-800 shadow-sm'}`}>
                                                        {msg.text}
                                                    </div>
                                                </div>
                                            ))}
                                            {isRoleplayLoading && <div className="text-xs text-gray-400 italic">AI æ­£åœ¨è¼¸å…¥...</div>}
                                        </div>
                                        <div className="p-2 border-t flex">
                                            <input 
                                                type="text" 
                                                value={roleplayInput}
                                                onChange={(e) => setRoleplayInput(e.target.value)}
                                                onKeyPress={(e) => e.key === 'Enter' && sendRoleplayMessage()}
                                                className="flex-1 border rounded-l-lg p-2 text-sm focus:outline-none focus:ring-1 focus:ring-pink-500"
                                                placeholder="è¼¸å…¥å›æ‡‰..."
                                                disabled={isRoleplayLoading}
                                            />
                                            <button onClick={sendRoleplayMessage} disabled={isRoleplayLoading} className="bg-pink-600 text-white px-4 rounded-r-lg text-sm hover:bg-pink-700">ç™¼é€</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>

                </div>
            )}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>